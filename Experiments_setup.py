from Agent import stupidAgent
from Bandit import Bandits
import numpy as np
def world(greedy_agent:stupidAgent, UCB_agent:stupidAgent, env:Bandits, stepLimit:int, do_debug:bool, do_plot:bool)->list[float]:
    curr_step = 0
    while curr_step < stepLimit:
        curr_step += 1
        greedyAction = greedy_agent.action_selection(method="greedy")
        greedyReward = env.play_bandit(ind=greedyAction)
        greedy_agent.update(action=greedyAction, reward=greedyReward)
        
        UCBAction = UCB_agent.action_selection(method="UCB")
        UCBReward = env.play_bandit(ind=UCBAction)
        UCB_agent.update(action=UCBAction, reward=UCBReward)
        
    greedy_agent.calculate_ess(true_dis=env.rewardChance)
    UCB_agent.calculate_ess(true_dis=env.rewardChance)
    if do_debug:
        env.debug()
        greedy_agent.debug()
        UCB_agent.debug() 
    print("greedy_agent best action, Bandit number(start with 0) : ", greedy_agent.bestAction)
    print("UCB_agent best action, Bandit number(start with 0) : ", UCB_agent.bestAction)
    if do_plot:
        greedy_agent.plot_actionCount()
        UCB_agent.plot_actionCount()
        greedy_agent.plot_history(name="action_value", true_dis=env.rewardChance)
        UCB_agent.plot_history(name="action_value", true_dis=env.rewardChance)
        greedy_agent.plot_history(name="reward",true_dis=None)
        UCB_agent.plot_history(name="reward", true_dis=None)
    return np.array([greedy_agent.ess, UCB_agent.ess])